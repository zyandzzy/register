# 任务系统使用指南

## 功能概览

本系统已完整实现所有需求的任务管理和数据分析功能。

## 任务管理页面

### 1. 创建根任务
- 点击右上角"创建任务"按钮
- 填写任务信息（标题、描述、状态、优先级、截止日期）
- 点击"创建"保存

### 2. 创建子任务
- 在任务列表中找到要拆解的任务
- 点击该任务行的"子任务"按钮
- 对话框会显示"为任务 'xxx' 创建子任务"提示
- 填写子任务信息
- 点击"创建"保存

**子任务识别**：
- 子任务在表格中有"└─"前缀标记
- "父任务"列显示父任务的ID
- 根任务显示"根任务"

### 3. 修改任务
- 点击任务行的"编辑"按钮
- 修改任务的任何属性
- 点击"更新"保存

### 4. 完成任务
- 点击"编辑"按钮
- 将状态改为"已完成"
- 点击"更新"

### 5. 删除任务
- 点击任务行的"删除"按钮
- 确认删除
- **重要**：如果任务有子任务，所有子任务会自动被递归删除

### 6. 查询任务
- 页面会自动加载所有任务（包括子任务）
- 任务按创建时间倒序排列
- 可以看到完整的任务层级结构

## 数据分析页面

访问路径：任务系统 → 数据分析

### 统计分析标签页

**概览统计**
- 4个统计卡片：总任务数、待处理、进行中、已完成
- 每个卡片显示数量和百分比

**任务完成率**
- 进度条可视化展示完成率
- 颜色随完成率变化（红→黄→绿）

**任务状态分布**
- 表格显示各状态的任务数量和占比
- 进度条可视化展示

**操作日志统计**
- 显示创建、更新、删除操作的次数
- 可视化条形图展示

### 操作记录标签页

**查看日志**
- 显示所有操作记录
- 包含：日志ID、任务ID、操作类型、描述、时间

**删除日志**
- 点击日志行的"删除"按钮
- 确认后删除该条记录
- 适用于删除错误的操作记录

**刷新数据**
- 点击页面右上角"刷新数据"按钮
- 同时刷新统计信息和操作记录

## 数据自动记录

所有任务操作都会自动产生日志：
- 创建任务 → 记录"创建任务"
- 更新任务 → 记录"更新任务"
- 删除任务 → 记录"删除任务"

这些日志独立于任务存储，即使任务被删除，日志依然保留（除非手动删除）。

## 任务层级示例

```
根任务1 (ID: 1)
  └─ 子任务1-1 (ID: 2, parent_id: 1)
  └─ 子任务1-2 (ID: 3, parent_id: 1)
      └─ 子任务1-2-1 (ID: 4, parent_id: 3)

根任务2 (ID: 5)
  └─ 子任务2-1 (ID: 6, parent_id: 5)
```

**删除行为**：
- 删除"根任务1" → 自动删除 ID 2, 3, 4
- 删除"子任务1-2" → 自动删除 ID 4

## API 接口

### 任务管理
- `POST /api/task/create` - 创建任务/子任务
- `POST /api/task/update/{id}` - 更新任务
- `DELETE /api/task/delete/{id}` - 删除任务（级联删除子任务）
- `GET /api/task/list` - 获取所有任务
- `GET /api/task/subtasks/{parentId}` - 获取子任务列表

### 日志管理
- `GET /api/task-log/user-logs` - 获取用户所有日志
- `GET /api/task-log/statistics` - 获取统计信息
- `DELETE /api/task-log/delete/{id}` - 删除日志记录

## 常见问题

**Q: 如何创建多级子任务？**
A: 先创建一级子任务，然后为该子任务创建子任务，形成多级结构。

**Q: 删除父任务会怎样？**
A: 所有子任务（包括子任务的子任务）都会被递归删除。

**Q: 如何查看任务的操作历史？**
A: 在"数据分析"页面的"操作记录"标签页查看。

**Q: 删除的任务还能恢复吗？**
A: 任务删除后无法恢复，但操作日志会保留，除非手动删除日志。

**Q: 如何区分根任务和子任务？**
A: 看"父任务"列，显示"根任务"的是根任务，显示ID的是子任务。

## 技术特性

- ✅ RESTful API 设计
- ✅ JWT 身份认证
- ✅ 递归级联删除
- ✅ 自动日志记录
- ✅ 实时统计更新
- ✅ 响应式UI设计
